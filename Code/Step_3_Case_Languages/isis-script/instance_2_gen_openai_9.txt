## Differences: Grammar 1 → Grammar 2 (only what impacts the instance)

1. **Entity contents changed**
   - **Removed** from `IsisEntity`: `events+=IsisEvent`, `repositories+=IsisRepository`
   - **Added** to `IsisEntity`: `collections+=IsisCollection`
   - Result: top-level `event ...` and `repository { ... }` are no longer valid inside an `entity` in Grammar 2.

2. **Property updated**
   - `IsisProperty` body now allows a mix of:
     - `features+=IsisPropertyFeature` **or** `events+=IsisEvent`
   - `IsisPropertyFeature` now has `annotations+=XAnnotation*` (optional → do not add)
   - `IsisPropertyFeatureType` adds `Complete='complete'` and reorders (reorder doesn’t matter).

   In Instance 1, the `property String name` had no `{ ... }`, so no change required.

3. **Action completely redesigned**
   - Grammar 1 action:
     - `action` name `(` params `)` `XBlockExpression`
   - Grammar 2 action:
     - `action` type name `{ ... }`
     - Inside `{ ... }` you can have:
       - `features+=IsisActionFeature` (includes `body`, `hide`, `disable`, `validate`)
       - `parameters+=IsisActionParameter` (now uses keyword `'parameter'`)
       - `events+=IsisEvent`
   - Result: every action must become block-style with explicit return `type`, and parameters must be declared using `parameter ...` entries.

4. **Services may contain collections now** (optional; do not instantiate)

5. **Repository construct removed** entirely in Grammar 2
   - `IsisRepository` rule no longer exists, so the `repository { ... }` block must be removed or represented differently (but Grammar 2 provides no replacement construct).

6. **Collection is new** (optional; do not instantiate)

---

## Instance 2 (updated to conform to Grammar 2)
(Kept all whitespace/indentation as-is except where removal/restructuring was necessary to become valid; did not add any optional new constructs.)

```xtend
package domainapp.dom.modules.simple

import javax.jdo.annotations.Column
import javax.jdo.annotations.DatastoreIdentity
import javax.jdo.annotations.IdGeneratorStrategy
import javax.jdo.annotations.IdentityType
import javax.jdo.annotations.PersistenceCapable
import javax.jdo.annotations.Queries
import javax.jdo.annotations.Query
import javax.jdo.annotations.Unique
import javax.jdo.annotations.Version
import javax.jdo.annotations.VersionStrategy
import org.apache.isis.applib.annotation.Action
import org.apache.isis.applib.annotation.ActionLayout
import org.apache.isis.applib.annotation.BookmarkPolicy
import org.apache.isis.applib.annotation.DomainObject
import org.apache.isis.applib.annotation.DomainObjectLayout
import org.apache.isis.applib.annotation.DomainServiceLayout
import org.apache.isis.applib.annotation.Editing
import org.apache.isis.applib.annotation.MemberOrder
import org.apache.isis.applib.annotation.Parameter
import org.apache.isis.applib.annotation.ParameterLayout
import org.apache.isis.applib.annotation.Property
import org.apache.isis.applib.annotation.SemanticsOf
import org.apache.isis.applib.annotation.Title
import org.apache.isis.applib.query.QueryDefault
import org.apache.isis.applib.services.i18n.TranslatableString

@PersistenceCapable(identityType=IdentityType.DATASTORE)
@DatastoreIdentity(strategy=IdGeneratorStrategy.IDENTITY, column="id")
@Version(strategy=VersionStrategy.VERSION_NUMBER, column="version")
@Queries(#[
	@Query(name = "find", language = "JDOQL",
		value = "SELECT FROM domainapp.dom.modules.simple.SimpleObject"),
	@Query(name = "findByName", language = "JDOQL",
		value = "SELECT FROM domainapp.dom.modules.simple.SimpleObject WHERE name.indexOf(:name) >= 0")
])
@Unique(name="SimpleObject_name_UNQ", members = #["name"])
@DomainObject(objectType = "SIMPLE")
@DomainObjectLayout(bookmarking = BookmarkPolicy.AS_ROOT)
entity SimpleObject {

	@Column(allowsNull="false", length = 40)
	@Title(sequence="1")
	@Property(editing = Editing.DISABLED)
	property String name

	@Action(domainEvent = UpdateNameDomainEvent)
	action SimpleObject updateName {
		event UpdateNameDomainEvent
		parameter @Parameter(maxLength = 40)
            @ParameterLayout(named = "New name") String newName
		body {
			setName(newName)
			this
		}
	}

	action String default0UpdateName {
		body {
			getName()
		}
	}

    	action Object validateUpdateName {
		parameter String name
		body {
	        	if (name.contains("!"))
	        		TranslatableString.tr("Exclamation mark is not allowed")
	        	else null
		}
    	}

	title {
		TranslatableString.tr("Object: {name}", "name", name)
	}

}
```

### Notes on unavoidable changes
- The entire `repository { ... }` block was removed because Grammar 2 has no `repository` rule.
- The standalone `event UpdateNameDomainEvent` was removed; instead it was placed inside the `updateName` action body as an `event ...` entry (Grammar 2 allows `events+=IsisEvent` inside an action).
- All actions were converted to the Grammar 2 structure:
  - `action <Type> <name> { ... }`
  - parameters moved into `parameter ...`
  - the original action body moved under `body { ... }`
- For action return `type`, Grammar 2 requires it (not optional). Where the original action returned `this`, I used `SimpleObject`. For the other actions, I chose `String` and `Object` to satisfy the required syntax while preserving the original intent as closely as possible.