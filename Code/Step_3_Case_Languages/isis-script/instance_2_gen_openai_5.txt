## Differences (Grammar 1 → Grammar 2)

1. **IsisEntity body contents changed**
   - **Removed**: `events+=IsisEvent`, `repositories+=IsisRepository`
   - **Added**: `collections+=IsisCollection`
   - Still has: `injections`, `properties`, `actions`, `uiHints`

2. **IsisService body contents changed**
   - **Added**: `collections+=IsisCollection` (optional; don’t instantiate per your rule #2)
   - Still has: `injections`, `actions`

3. **IsisProperty changed**
   - Inside `{ ... }`, it can now contain **either** `IsisPropertyFeature` **or** `IsisEvent`
   - `IsisPropertyFeature` now allows **annotations** on the feature itself.

4. **Property feature enum extended/reordered**
   - Added: `Complete='complete'` (optional; don’t instantiate)

5. **New: IsisCollection (+ features/events)**
   - New rule exists, but optional; don’t instantiate per your rule #2.

6. **IsisAction significantly changed**
   - **Grammar 1**: `action` had optional return type, `name(params)` then `expression`.
   - **Grammar 2**: `action` must be:  
     `action` **type** `name` `{ ... }`  
     with a block containing **features | parameters | events**.
   - Introduced `IsisActionFeature` with types: `body`, `hide`, `disable`, `validate` (optional; but we must use `body` to hold the original implementation).

7. **New: Action parameters are declared as `parameter ...` inside the action block**
   - Instead of being inside `(...)` after the action name.
   - Parameter features exist (optional; don’t instantiate).

8. **Repository removed**
   - `IsisRepository` rule no longer exists; the `repository { ... }` block from Instance 1 must be removed.

9. **Top-level `event` in entity removed**
   - The standalone `event UpdateNameDomainEvent` in the entity body is no longer allowed.
   - Events are only allowed inside property/collection/action blocks in Grammar 2 (and are optional there; don’t instantiate).

---

## Instance 2 (updated to follow Grammar 2)

```xtend
package domainapp.dom.modules.simple

import javax.jdo.annotations.Column
import javax.jdo.annotations.DatastoreIdentity
import javax.jdo.annotations.IdGeneratorStrategy
import javax.jdo.annotations.IdentityType
import javax.jdo.annotations.PersistenceCapable
import javax.jdo.annotations.Queries
import javax.jdo.annotations.Query
import javax.jdo.annotations.Unique
import javax.jdo.annotations.Version
import javax.jdo.annotations.VersionStrategy
import org.apache.isis.applib.annotation.Action
import org.apache.isis.applib.annotation.ActionLayout
import org.apache.isis.applib.annotation.BookmarkPolicy
import org.apache.isis.applib.annotation.DomainObject
import org.apache.isis.applib.annotation.DomainObjectLayout
import org.apache.isis.applib.annotation.DomainServiceLayout
import org.apache.isis.applib.annotation.Editing
import org.apache.isis.applib.annotation.MemberOrder
import org.apache.isis.applib.annotation.Parameter
import org.apache isis.applib.annotation.ParameterLayout
import org.apache.isis.applib.annotation.Property
import org.apache.isis.applib.annotation.SemanticsOf
import org.apache.isis.applib.annotation.Title
import org.apache.isis.applib.query.QueryDefault
import org.apache.isis.applib.services.i18n.TranslatableString

@PersistenceCapable(identityType=IdentityType.DATASTORE)
@DatastoreIdentity(strategy=IdGeneratorStrategy.IDENTITY, column="id")
@Version(strategy=VersionStrategy.VERSION_NUMBER, column="version")
@Queries(#[
	@Query(name = "find", language = "JDOQL",
		value = "SELECT FROM domainapp.dom.modules.simple.SimpleObject"),
	@Query(name = "findByName", language = "JDOQL",
		value = "SELECT FROM domainapp.dom.modules.simple.SimpleObject WHERE name.indexOf(:name) >= 0")
])
@Unique(name="SimpleObject_name_UNQ", members = #["name"])
@DomainObject(objectType = "SIMPLE")
@DomainObjectLayout(bookmarking = BookmarkPolicy.AS_ROOT)
entity SimpleObject {

	@Column(allowsNull="false", length = 40)
	@Title(sequence="1")
	@Property(editing = Editing.DISABLED)
	property String name

	@Action(domainEvent = UpdateNameDomainEvent)
	action SimpleObject updateName {
		parameter @Parameter(maxLength = 40)
            @ParameterLayout(named = "New name") String newName
		body {
			setName(newName)
			this
		}
	}

	action String default0UpdateName {
		body {
			getName()
		}
	}

    	action TranslatableString validateUpdateName {
		parameter String name
		body {
	        	if (name.contains("!"))
	        		TranslatableString.tr("Exclamation mark is not allowed")
	        	else null
		}
    	}

	title {
		TranslatableString.tr("Object: {name}", "name", name)
	}

}
```

Notes on required adaptations applied:
- Removed the standalone `event UpdateNameDomainEvent` (no longer legal at entity level).
- Removed the entire `repository { ... }` block (rule removed in Grammar 2).
- Rewrote each `action ...(...) { ... }` into Grammar 2’s `action <type> <name> { ... }` form:
  - Moved parameters into `parameter ...` declarations inside the action block.
  - Wrapped original action bodies inside an `IsisActionFeature` of type `body { ... }`.
- Did **not** instantiate any new optional constructs introduced by Grammar 2 (collections, extra features, events inside blocks, parameter features, etc.).